<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Examples" href="examples.html" />

    <!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>ServiceX Client 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">ServiceX Client 3.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  
  <span class="sidebar-brand-text">ServiceX Client 3.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="servicex_client.html">ServiceXClient</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_identifier.html">DatasetIdentifier Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_group.html">DatasetGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="servicex-client">
<h1>ServiceX Client<a class="headerlink" href="#servicex-client" title="Permalink to this heading">#</a></h1>
<p>Python SDK and CLI Client for ServiceX</p>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">#</a></h2>
<p>The client relies on a YAML file to obtain the URLs of different
servicex deployments, as well as tokens to authenticate with the
service. The file should be named <code class="docutils literal notranslate"><span class="pre">.servicex</span></code> and the format of this
file is as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">api_endpoints</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://localhost:5000</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://servicex-release-testing-4.servicex.ssl-hep.org</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing4</span>
<span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">default_endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing4</span>

<span class="nt">cache_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/ServiceX_Client/cache-dir</span>
<span class="nt">shortened_downloaded_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">default_endpoint</span></code> will be used if otherwise not specified. The
cache database and downloaded files will be stored in the directory
specified by <code class="docutils literal notranslate"><span class="pre">cache_path</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">shortened_downloaded_filename</span></code> property controls whether
downloaded files will have their names shortened for convenience.
Setting to false preserves the full filename from the dataset. `</p>
<p>The library will search for this file in the current working directory
and then start looking in parent directories until a file is found.</p>
</section>
<section id="command-line-interface">
<h2>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this heading">#</a></h2>
<p>When installed, the client provides a new command in your shell,
<code class="docutils literal notranslate"><span class="pre">servicex</span></code>. This command uses a series of subcommands to work with
various functions of serviceX.</p>
<p>Common command line arguments:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>F
lag</p></th>
<th class="head"><p>Long
Flag</p></th>
<th class="head"><p>What it does</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-u</p></td>
<td><p>–url</p></td>
<td><p>The url of the serviceX ingress</p></td>
</tr>
<tr class="row-odd"><td><p>-b</p></td>
<td><p>–backend</p></td>
<td><p>Named backend from the .servicex file endpoints
list</p></td>
</tr>
</tbody>
</table>
</div>
<p>If neither url nor backend are specified then the client will attempt to
use the <code class="docutils literal notranslate"><span class="pre">default_endpoint</span></code> value to determine who to talk to.</p>
<section id="codegens">
<h3>codegens<a class="headerlink" href="#codegens" title="Permalink to this heading">#</a></h3>
<p>This command will list the code generators deployed.</p>
</section>
<section id="transforms">
<h3>transforms<a class="headerlink" href="#transforms" title="Permalink to this heading">#</a></h3>
<p>These commands interact with transforms that have been run</p>
<section id="list">
<h4>list<a class="headerlink" href="#list" title="Permalink to this heading">#</a></h4>
<p>List transforms associated with the current user. Add the <code class="docutils literal notranslate"><span class="pre">--complete</span></code>
flag to only show transforms that have completed.</p>
</section>
<section id="files">
<h4>files<a class="headerlink" href="#files" title="Permalink to this heading">#</a></h4>
<p>List the files along with their size generated by a transform. Specify
the transform request id with the <code class="docutils literal notranslate"><span class="pre">-t</span></code> or <code class="docutils literal notranslate"><span class="pre">--transform-id</span></code> flag</p>
</section>
<section id="download">
<h4>download<a class="headerlink" href="#download" title="Permalink to this heading">#</a></h4>
<p>Download the files from a transform to a local directory. Specify the
transform request id with <code class="docutils literal notranslate"><span class="pre">-t</span></code> and the directory to download to with
<code class="docutils literal notranslate"><span class="pre">-d</span></code>. Defaults to downloading files to the current working directory.</p>
</section>
</section>
<section id="cache">
<h3>cache<a class="headerlink" href="#cache" title="Permalink to this heading">#</a></h3>
<p>These commands allow you to work with the query cache maintained by the
serviceX client.</p>
<section id="list-1">
<span id="id1"></span><h4>list<a class="headerlink" href="#list-1" title="Permalink to this heading">#</a></h4>
<p>Show all of the cached transforms along with the run time, code
generator, and number of resulting files</p>
</section>
<section id="delete">
<h4>delete<a class="headerlink" href="#delete" title="Permalink to this heading">#</a></h4>
<p>Delete a specific transform from the cache. Provide the transform
request ID with the <code class="docutils literal notranslate"><span class="pre">-t</span></code> or <code class="docutils literal notranslate"><span class="pre">--transform-id</span></code> arg.</p>
</section>
<section id="clear">
<h4>clear<a class="headerlink" href="#clear" title="Permalink to this heading">#</a></h4>
<p>Clear all of the transforms from the cache. Add <code class="docutils literal notranslate"><span class="pre">-y</span></code> to force the
operation without confirming with the console.</p>
</section>
</section>
</section>
<section id="python-sdk">
<h2>Python SDK<a class="headerlink" href="#python-sdk" title="Permalink to this heading">#</a></h2>
<p>Entry to the SDK starts with constructing an instance of ServiceXClient.
The constructor accepts <code class="docutils literal notranslate"><span class="pre">backend</span></code> argument to specify a named backend
from the <code class="docutils literal notranslate"><span class="pre">.servicex</span></code> file, or <code class="docutils literal notranslate"><span class="pre">url</span></code> for the direct URL to a serviceX
server. With the URL option you can’t provide a token from <code class="docutils literal notranslate"><span class="pre">.servicex</span></code>
so it must either be an unsecured endpoint, or the token must be
provided via the WLCG standard of a file pointed to by
<code class="docutils literal notranslate"><span class="pre">BEARER_TOKEN_FILE</span></code> environment variable.</p>
<p>With an instance of ServiceXClient you can - List the code generators
deployed with the ServiceX instance - List the transformers that have
been run - Get the current status of a specific transform</p>
<section id="create-a-dataset-instance-to-run-transforms">
<h3>Create a Dataset Instance to Run Transforms<a class="headerlink" href="#create-a-dataset-instance-to-run-transforms" title="Permalink to this heading">#</a></h3>
<p>The ServiceX client also can create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> instance that allows
you to specify a query, provide a dataset identifier, and retrieve the
results of the resulting transform request.</p>
<p>There are two types of datasets - func_adl_dataset - Python Function
dataset</p>
</section>
<section id="dataset-identifiers">
<h3>Dataset Identifiers<a class="headerlink" href="#dataset-identifiers" title="Permalink to this heading">#</a></h3>
<p>Before we get too deeply into the dataset classes, we should look at how
to specify a dataset. - RucioDatasetIdentifier - for retrieving data
files registered with Rucio - FileListDataset - A list of URIs for
accessing files using xRootd</p>
</section>
<section id="funcadl-dataset">
<h3>FuncADL Dataset<a class="headerlink" href="#funcadl-dataset" title="Permalink to this heading">#</a></h3>
<p>This dataset is controlled by the func_adl language. The dataset
supports the <code class="docutils literal notranslate"><span class="pre">Select</span></code>, <code class="docutils literal notranslate"><span class="pre">SelectMany</span></code>, <code class="docutils literal notranslate"><span class="pre">Where</span></code>, <code class="docutils literal notranslate"><span class="pre">MetaData</span></code>, and
<code class="docutils literal notranslate"><span class="pre">QMetaData</span></code> operators from func_adl.</p>
</section>
<section id="datasets">
<h3>Datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">#</a></h3>
<p>This is the abstract class for requesting data from ServiceX. You have
to specify the dataset identifier you want data from and provide some
sort of selection query. You can set the result format with the
<code class="docutils literal notranslate"><span class="pre">set_result_format</span></code> operator (it’s also a factory method arg for the
dataset).</p>
<p>Operators that cause the client to interact with the server: These
terminal operators will call out to the serviceX server and process
results. They are all implemented as asynchronous coroutines, but they
also come with synchronous versions to make it easy to do easy things.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#simple-func-adl-example">Simple Func_ADL Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#func-adl-example-with-rucio-dataset">Func_ADL Example With Rucio Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#python-code-generator">Python Code Generator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="servicex_client.html">ServiceXClient</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_identifier.html">DatasetIdentifier Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_group.html">DatasetGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#endpoint">Endpoint</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Examples</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Ben Galewsky, Gordon Watts
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ServiceX Client</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#command-line-interface">Command Line Interface</a><ul>
<li><a class="reference internal" href="#codegens">codegens</a></li>
<li><a class="reference internal" href="#transforms">transforms</a><ul>
<li><a class="reference internal" href="#list">list</a></li>
<li><a class="reference internal" href="#files">files</a></li>
<li><a class="reference internal" href="#download">download</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache">cache</a><ul>
<li><a class="reference internal" href="#list-1">list</a></li>
<li><a class="reference internal" href="#delete">delete</a></li>
<li><a class="reference internal" href="#clear">clear</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#python-sdk">Python SDK</a><ul>
<li><a class="reference internal" href="#create-a-dataset-instance-to-run-transforms">Create a Dataset Instance to Run Transforms</a></li>
<li><a class="reference internal" href="#dataset-identifiers">Dataset Identifiers</a></li>
<li><a class="reference internal" href="#funcadl-dataset">FuncADL Dataset</a></li>
<li><a class="reference internal" href="#datasets">Datasets</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>